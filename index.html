<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cricket Field & Fielder Placement Visualizer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --field-radius-m: 68;
      --inner-circle-m: 27.432; /* 30 yards */
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f6f3ed;
      color: #222;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      min-height: 100vh;
    }

    h1 { margin: 16px 0 0; text-align: center; }
    .subtitle { text-align: center; color: #666; margin-bottom: 10px; }

    .layout { display: flex; flex: 1; padding: 12px 16px; gap: 16px; }
    @media (max-width:900px){ .layout{flex-direction:column;} }

    .field-wrapper { flex:1; display:flex; align-items:center; justify-content:center; }
    .field-card {
      background:#fff; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.1);
      width:100%; max-width:640px; aspect-ratio:1/1; padding:12px;
      display:flex; align-items:center; justify-content:center;
    }
    #fieldSvg { width:100%; height:100%; touch-action:none; }

    .controls {
      flex:0 0 320px; background:#fff; border-radius:16px;
      box-shadow:0 8px 20px rgba(0,0,0,0.1); padding:12px 14px;
      display:flex; flex-direction:column; gap:10px;
    }
    @media (max-width:900px){ .controls{max-width:100%;} }

    .controls-section { border-bottom:1px solid #eee; padding-bottom:8px; }
    .controls-section:last-of-type{border-bottom:none;}
    .controls-section h2{font-size:1rem;margin:4px 0 6px;}

    .slider-row{display:flex;align-items:center;gap:8px;}
    .slider-row span{font-size:0.85rem;color:#555;}

    .fielder-list{overflow-y:auto;max-height:60vh;}
    .fielder-row{background:#faf7f3;border:1px solid #eee;border-radius:10px;
      padding:6px 8px;margin-bottom:6px;}
    .fielder-row-header{font-weight:600;font-size:0.85rem;margin-bottom:4px;}
    .fielder-row label{font-size:0.8rem;display:flex;justify-content:space-between;align-items:center;margin:2px 0;}
    .fielder-row input[type=text]{flex:1;margin-left:6px;padding:2px 4px;font-size:0.8rem;}
    .fielder-row input[type=color]{margin-left:6px;width:28px;height:20px;}
    .fielder-row input[type=checkbox]{margin-left:6px;}

    .mirror-toggle{display:flex;align-items:center;gap:6px;font-size:0.9rem;}
    .note{font-size:0.75rem;color:#777;}
  </style>
</head>
<body>
  <h1>Cricket Field Placement Visualizer</h1>
  <div class="subtitle">Drag fielders, set colors & labels, mirror for different batters.</div>

  <div class="layout">
    <div class="field-wrapper">
      <div class="field-card">
        <svg id="fieldSvg" viewBox="-75 -75 150 150">
          <circle cx="0" cy="0" r="68" fill="#c1e8b5" stroke="#0b6820" stroke-width="0.7"/>
          <circle cx="0" cy="0" r="27.432" fill="none" stroke="#0b6820" stroke-dasharray="1.2 1.2" stroke-width="0.5"/>
          <rect x="-2.5" y="-10" width="5" height="20" rx="1.5" ry="1.5" fill="#e0c6a2" stroke="#b89463" stroke-width="0.4"/>
          <rect x="-0.6" y="-10.5" width="1.2" height="1.3" fill="#444"></rect>
          <rect x="-0.6" y="9.2" width="1.2" height="1.3" fill="#444"></rect>

          <text id="offLabel" x="-40" y="0" text-anchor="middle" font-size="6"
            fill="#004b23" opacity="0.18" style="letter-spacing:2px;">OFF SIDE</text>
          <text id="legLabel" x="40" y="0" text-anchor="middle" font-size="6"
            fill="#7f1d1d" opacity="0.18" style="letter-spacing:2px;">LEG SIDE</text>

          <g id="fieldersGroup"></g>
        </svg>
      </div>
    </div>

    <div class="controls">
      <div class="controls-section">
        <h2>Global Settings</h2>
        <div class="slider-row">
          <span>Fielder size</span>
          <input type="range" id="sizeSlider" min="1" max="5" step="0.2" value="2.5">
        </div>
        <label class="mirror-toggle"><input type="checkbox" id="mirrorToggle"> Mirror field</label>
        <label class="mirror-toggle"><input type="checkbox" id="hideAllLabels"> Hide all labels</label>
      </div>

      <div class="controls-section">
        <h2>Fielder Controls</h2>
        <div class="fielder-list" id="fielderControls"></div>
      </div>
    </div>
  </div>

  <script>
  (function(){
    const svg=document.getElementById("fieldSvg");
    const fieldersGroup=document.getElementById("fieldersGroup");
    const sizeSlider=document.getElementById("sizeSlider");
    const mirrorToggle=document.getElementById("mirrorToggle");
    const hideAllLabels=document.getElementById("hideAllLabels");
    const fielderControls=document.getElementById("fielderControls");
    const offLabel=document.getElementById("offLabel"), legLabel=document.getElementById("legLabel");
    const FIELD_RADIUS=68, FIELDER_COUNT=11;
    let fielderSize=parseFloat(sizeSlider.value), isMirrored=false, labelsHiddenAll=false;
    const fielders=[], pt=svg.createSVGPoint(); let active=null;

    function getSvgCoords(evt){pt.x=evt.clientX;pt.y=evt.clientY;
      const ctm=svg.getScreenCTM();if(!ctm)return{x:0,y:0};
      const inv=ctm.inverse(),p=pt.matrixTransform(inv);return{x:p.x,y:p.y};}
    function clamp(x,y,r){const d=Math.sqrt(x*x+y*y);if(d<=r)return{x,y};const s=r/d;return{x:x*s,y:y*s};}

    function createFielders(){
      const ring=35;
      for(let i=0;i<FIELDER_COUNT;i++){
        const a=2*Math.PI*i/FIELDER_COUNT, x=ring*Math.cos(a), y=ring*Math.sin(a);
        const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
        c.setAttribute("r",fielderSize); c.setAttribute("fill","#1d4ed8"); c.setAttribute("stroke","#222"); c.setAttribute("stroke-width","0.4");
        c.dataset.index=i; c.style.cursor="grab";
        const t=document.createElementNS("http://www.w3.org/2000/svg","text");
        t.setAttribute("text-anchor","middle"); t.setAttribute("dominant-baseline","central");
        fieldersGroup.append(c,t);
        fielders.push({i,x,y,color:"#1d4ed8",name:"",hidden:false,circle:c,label:t});
      }
      updateAll();
    }

    function updateSideLabels(){
      const offX=isMirrored?40:-40, legX=isMirrored?-40:40;
      offLabel.setAttribute("x",offX); legLabel.setAttribute("x",legX);
    }

    function updateFielder(f){
      const dx=isMirrored?-f.x:f.x, dy=f.y;
      f.circle.setAttribute("cx",dx); f.circle.setAttribute("cy",dy);
      f.circle.setAttribute("r",fielderSize); f.circle.setAttribute("fill",f.color);
      const txt=f.name.trim()||`F${f.i+1}`;
      f.label.textContent=txt;
      f.label.setAttribute("x",dx);
      f.label.setAttribute("y",dy-(fielderSize+2.0)); // increased spacing
      f.label.setAttribute("font-size",fielderSize*1.5);
      f.label.style.display=(f.hidden||labelsHiddenAll)?"none":"block";
    }

    function updateAll(){fielders.forEach(updateFielder);}

    function buildControls(){
      fielderControls.innerHTML="";
      fielders.forEach(f=>{
        const row=document.createElement("div"); row.className="fielder-row";
        row.innerHTML=`<div class='fielder-row-header'>Fielder ${f.i+1}</div>`;
        const nameLbl=document.createElement("label");
        nameLbl.innerHTML=`Label <input type="text" value="${f.name}" data-i="${f.i}">`;
        const colorLbl=document.createElement("label");
        colorLbl.innerHTML=`Color <input type="color" value="${f.color}" data-i="${f.i}">`;
        const hideLbl=document.createElement("label");
        hideLbl.innerHTML=`Hide label <input type="checkbox" data-i="${f.i}">`;
        row.append(nameLbl,colorLbl,hideLbl); fielderControls.append(row);

        nameLbl.querySelector("input").oninput=e=>{
          f.name=e.target.value;updateFielder(f);
        };
        colorLbl.querySelector("input").oninput=e=>{
          f.color=e.target.value;updateFielder(f);
        };
        hideLbl.querySelector("input").onchange=e=>{
          f.hidden=e.target.checked;updateFielder(f);
        };
      });
    }

    function pointerDown(e){
      if(!(e.target instanceof SVGCircleElement))return;
      const i=parseInt(e.target.dataset.index);active=fielders[i];
      e.target.style.cursor="grabbing";e.preventDefault();
    }
    function pointerMove(e){
      if(!active)return;
      const {x,y}=getSvgCoords(e);
      const p=clamp(x,y,FIELD_RADIUS-fielderSize*0.8);
      active.x=isMirrored?-p.x:p.x;active.y=p.y;updateFielder(active);
    }
    function pointerUp(){if(active){active.circle.style.cursor="grab";active=null;}}

    svg.addEventListener("pointerdown",pointerDown);
    svg.addEventListener("pointermove",pointerMove);
    svg.addEventListener("pointerup",pointerUp);
    svg.addEventListener("pointerleave",pointerUp);

    sizeSlider.oninput=()=>{fielderSize=parseFloat(sizeSlider.value);updateAll();};
    mirrorToggle.onchange=()=>{isMirrored=mirrorToggle.checked;updateSideLabels();updateAll();};
    hideAllLabels.onchange=()=>{labelsHiddenAll=hideAllLabels.checked;updateAll();};

    createFielders(); buildControls(); updateSideLabels();
  })();
  </script>
</body>
</html>
